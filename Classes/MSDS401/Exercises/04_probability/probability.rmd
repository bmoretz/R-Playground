---
title: "Lesson 04: Probability"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  html_document:
    toc: true
    toc_float: true
    theme: spacelab
    df_print: paged
---

```{r knitr-setup, include = FALSE}
library(knitr)

knitr::opts_chunk$set(eval = TRUE)

opts_chunk$set(fig.align = "center", fig.height = 4, fig.width = 8) # for html
opts_knit$set(progress = FALSE, verbose = TRUE)

```


```{r additional-libraries, echo=FALSE}

library(data.table, quietly = TRUE, warn.conflicts = FALSE)

assignInNamespace("cedta.pkgEvalsUserCode", c(data.table:::cedta.pkgEvalsUserCode, "rtvs"), "data.table")

library(dplyr, quietly = TRUE, warn.conflicts = FALSE)
library(ggplot2, quietly = TRUE, warn.conflicts = FALSE)
library(ggthemes, quietly = TRUE, warn.conflicts = FALSE)
library(gridExtra, quietly = TRUE, warn.conflicts = FALSE)

theme_set(theme_fivethirtyeight())

# Theme Overrides
theme_update(plot.title = element_text(hjust = 0.5),
             axis.text.x = element_text(face = "bold", size = 12),
             axis.text.y = element_text(face = "bold", size = 12),
             legend.position = "top", legend.title = element_blank())

#base.dir <- "E:/GitHub/R-Playground/"
base.dir <- "C:/Projects/R/Playground"

data.path <- paste0(base.dir, "/Classes/MSDS401/Exercises/04_probability/data/")

loadDataFile <- function(file_name) {
	data.raw <- fread(paste0(data.path, file_name),
		header = TRUE, stringsAsFactors = FALSE, na.strings = c("NA", ""))

	data <- setNames(data.raw, tools::toTitleCase(tolower(names(data.raw))))

	return(data)
}

```


```{r ex_3_util, echo = FALSE}

```

## 1.) Shoppers

+ __Dataset__: _shoppers.csv_

```{r ex_1_data, echo = FALSE}

shoppers <- loadDataFile("shoppers.csv")

glimpse(shoppers)

```

Assume the fifty shoppers exit the store individually in random order.

### a.)

> If one shopper is picked at random, what is the probability of picking a shopper who spent
$40 or more dollars? What is the probability of picking a shopper who spent less than $10?

```{r ex_1_a, echo = T}

n <- length(shoppers$Spending)

gte_40 <- sum(shoppers$Spending >= 40)
gte_40 / n

lt_10 <- sum(shoppers$Spending < 10)
lt_10 / n

```

### b.)

> If two shoppers are picked at random, what is the probability the pair will include a shopper
who spent $40 or more dollars and one who spent less than $10?

```{r ex_1_b, echo = T}

gte_40 * lt_10 / ( n * ( n - 1 ) / 2 )

```

_Hint : For parts c) and d) it will be necessary to assume sampling without replacement._

### c.) 

> If two shoppers are picked at random, what is the probability the pair will include two
shoppers who spent no less than $10 and no more than $40?

```{r}

m <- sum( (shoppers$Spending >= 10) & (shoppers$Spending <= 40))

m * (m - 1) / ( n * (n - 1) )

```

### d.)

> If four shoppers are picked at random, what is the probability one shopper will have spent
less than $10, one shopper will have spent $40 or more dollars and two shoppers will have
spent no less than $10 and no more than $40?

```{r}

successful_combinations <- gte_40 * lt_10 * m * (m - 1) / 2
total_combinations <- dim( combn( n, 4 ) )[ 2 ]

successful_combinations / total_combinations

```

## e.)

> If we know a randomly picked shopper has spent more than $30, what is the probability that
shopper has spent more than $40?

```{r}

g1 <- sum(shoppers$Spending > 30)
g2 <- sum(shoppers$Spending > 40)

g2 / g1

```

## 2.)

# Use R to answer these questions

### a.) 

Draw 100 samples with replacement of size 22 from the 365 integers (i.e. 1,2,.,365). Count
the number of samples in which one or more of the numbers sampled is duplicated. Divide
by 100 to estimate the probability of such duplication occurring. (If 22 people are selected
at random, what is the probability of two or more matching birthdays?)

```{r}


```
